"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[790],{6790:(e,a,s)=>{s.r(a),s.d(a,{default:()=>f});var t=s(5155),i=s(2115),r=s(3824),l=s(5404),n=s(9280);s(8851),s(2465);var c=s(9932),d=s(760),o=s(1154),m=s(1767),x=s(9621),h=s(7434),p=s(7924),u=s(3786),y=s(1243),b=s(7863),j=s(6474),N=s(6874),g=s.n(N);function f(e){let{url:a,teaching_plan_link:N}=e,[f,w]=(0,i.useState)(),[v,P]=(0,i.useState)(1),[A,k]=(0,i.useState)(null),[S,C]=(0,i.useState)(!1),[T,F]=(0,i.useState)(1),[H,D]=(0,i.useState)(null),[E,L]=(0,i.useState)(null),[_,M]=(0,i.useState)(!0);return((0,i.useEffect)(()=>{r.EA.workerSrc=new s.U(s(7266)).toString(),C(!0),(async()=>{try{M(!0);let e=await fetch(a),s=e.headers.get("Content-Type")||"";if(L(s),!s.includes("application/pdf")){let a=await e.text();D(a),s.includes("text/html")||s.includes("text/plain")||k("不支援的檔案類型: ".concat(s))}}catch(e){console.error("Error fetching content:",e),k("無法載入內容")}finally{M(!1)}})()},[a]),!S||_)?(0,t.jsxs)(c.P.div,{className:"flex flex-col items-center justify-center py-20",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[(0,t.jsx)(o.A,{className:"h-10 w-10 text-blue-500 animate-spin mb-4"}),(0,t.jsx)("p",{className:"text-gray-600 font-medium",children:"確認教學計劃表狀態中⋯"})]}):H&&E?(0,t.jsx)(d.N,{mode:"wait",children:(0,t.jsxs)(c.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.4},children:[(0,t.jsxs)("div",{className:"rounded-lg overflow-hidden border border-amber-200 mb-4",children:[(0,t.jsxs)("div",{className:"bg-amber-50 p-4 flex items-center gap-3",children:[(0,t.jsx)(m.A,{className:"text-amber-500 h-5 w-5"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-amber-800 font-medium",children:"伺服器傳回非 PDF 內容"}),(0,t.jsxs)("p",{className:"text-amber-700 text-sm",children:["內容類型: ",E]})]})]}),E.includes("text/html")?(0,t.jsxs)(c.P.div,{className:"bg-white p-4 border-t border-amber-100",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:[(0,t.jsxs)("div",{className:"mb-3 flex items-center",children:[(0,t.jsx)(x.A,{className:"text-blue-500 h-4 w-4 mr-2"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"HTML 內容預覽"})]}),(0,t.jsx)("div",{className:"border border-gray-200 rounded-md p-4 bg-gray-50 overflow-auto max-h-[500px]",children:(0,t.jsx)("iframe",{srcDoc:H,className:"w-full h-[400px] border-0",title:"Response Content"})}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsxs)("details",{className:"bg-gray-50 rounded-md",children:[(0,t.jsx)("summary",{className:"p-2 cursor-pointer text-sm text-gray-700 font-medium",children:"查看原始 HTML"}),(0,t.jsx)("pre",{className:"text-xs p-3 overflow-auto max-h-[300px] bg-gray-100 border-t border-gray-200 rounded-b-md",children:H})]})})]}):(0,t.jsxs)(c.P.div,{className:"bg-white p-4 border-t border-amber-100",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:[(0,t.jsxs)("div",{className:"mb-3 flex items-center",children:[(0,t.jsx)(h.A,{className:"text-blue-500 h-4 w-4 mr-2"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"文字內容"})]}),(0,t.jsx)("pre",{className:"bg-gray-50 p-4 rounded-md overflow-auto text-sm text-gray-700 max-h-[500px] border border-gray-200",children:H})]})]}),(0,t.jsxs)(c.P.div,{className:"bg-blue-50 p-4 rounded-lg border border-blue-100 text-blue-700 mb-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:[(0,t.jsx)("p",{className:"text-sm",children:"可能原因："}),(0,t.jsxs)("ul",{className:"list-disc pl-5 mt-2 text-sm space-y-1",children:[(0,t.jsx)("li",{children:"該課程沒有上傳，或不需要上傳課程計畫表"}),(0,t.jsx)("li",{children:"教學計畫表不存在或已移除"}),(0,t.jsx)("li",{children:"校務系統暫時的故障"})]}),(0,t.jsxs)("div",{className:"mt-3 text-sm flex items-center space-x-1",children:[(0,t.jsx)("p",{children:"如欲確認詳細狀況，建議使用以下連結確認："}),(0,t.jsxs)(g(),{href:"https://sys.ndhu.edu.tw/aa/class/course/",target:"_blank",rel:"noopener noreferrer",className:"underline flex items-center space-x-1",children:[(0,t.jsx)(p.A,{className:"h-4 w-4 inline-block"}),"東華課程查詢系統"]}),"、",(0,t.jsxs)(g(),{href:N,target:"_blank",rel:"noopener noreferrer",className:"underline flex items-center space-x-1",children:[(0,t.jsx)(u.A,{className:"h-4 w-4 inline-block"}),"教學計畫表連結"]})]})]})]})}):(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(d.N,{mode:"wait",children:A?(0,t.jsxs)(c.P.div,{className:"text-center py-8 px-4 bg-red-50 rounded-lg border border-red-100 text-red-600 shadow-sm",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},children:[(0,t.jsx)(y.A,{className:"h-12 w-12 mx-auto mb-3 text-red-500"}),(0,t.jsx)("p",{className:"text-lg font-medium mb-2",children:"載入 PDF 時發生錯誤"}),(0,t.jsx)("p",{children:"請確認連結是否有效，或稍後再試。"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.P.div,{className:"sticky top-20 z-30 mx-auto w-fit mb-4",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.3},children:(0,t.jsxs)("div",{className:"bg-white/90 backdrop-blur-sm rounded-full px-4 py-2 shadow-md border border-gray-200 flex items-center space-x-3",children:[(0,t.jsx)(c.P.button,{onClick:()=>P(1),className:"p-2 rounded-full hover:bg-gray-100 text-gray-700",whileHover:{scale:1.1},whileTap:{scale:.9},disabled:1===v,children:(0,t.jsx)(b.A,{className:"h-4 w-4"})}),(0,t.jsx)(c.P.button,{onClick:()=>{v>1&&P(v-1)},className:"p-2 rounded-full hover:bg-gray-100 text-gray-700",whileHover:{scale:1.1},whileTap:{scale:.9},disabled:1===v,children:(0,t.jsx)(b.A,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{className:"text-sm font-medium text-gray-700 min-w-16 text-center",children:[v," / ",f||"--"]}),(0,t.jsx)(c.P.button,{onClick:()=>{f&&v<f&&P(v+1)},className:"p-2 rounded-full hover:bg-gray-100 text-gray-700",whileHover:{scale:1.1},whileTap:{scale:.9},disabled:!f||v===f,children:(0,t.jsx)(j.A,{className:"h-5 w-5"})}),(0,t.jsx)(c.P.button,{onClick:()=>f&&P(f),className:"p-2 rounded-full hover:bg-gray-100 text-gray-700",whileHover:{scale:1.1},whileTap:{scale:.9},disabled:!f||v===f,children:(0,t.jsx)(j.A,{className:"h-4 w-4"})})]})}),(0,t.jsx)(c.P.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6},className:"flex flex-col items-center",children:(0,t.jsx)(l.A,{file:a,onLoadSuccess:function(e){let{numPages:a}=e;w(a),M(!1)},onLoadError:function(e){console.error("PDF loading error:",e),k("無法載入 PDF 文件"),M(!1)},className:"flex flex-col items-center",loading:(0,t.jsxs)(c.P.div,{className:"text-center py-16",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:[(0,t.jsx)(o.A,{className:"h-10 w-10 text-blue-500 animate-spin mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-blue-500 font-medium",children:"載入 PDF 中..."})]}),error:(0,t.jsxs)(c.P.div,{className:"text-center py-10 text-red-500",initial:{opacity:0},animate:{opacity:1},children:[(0,t.jsx)(y.A,{className:"h-8 w-8 mx-auto mb-2"}),"無法載入 PDF，請檢查連結是否有效"]}),children:(0,t.jsx)(d.N,{mode:"wait",children:(0,t.jsx)(c.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:(0,t.jsx)(n.A,{pageNumber:v,className:"mb-4 shadow-lg rounded overflow-hidden",width:window.innerWidth>768?800*T:(window.innerWidth-40)*T,renderTextLayer:!0,renderAnnotationLayer:!0,scale:T})},v)})})}),f&&f>0&&(0,t.jsxs)(c.P.div,{className:"text-center text-sm text-gray-500 mt-2 mb-8 flex flex-col items-center space-y-2",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:[(0,t.jsxs)("div",{className:"flex items-center justify-center space-x-1",children:[(0,t.jsx)(h.A,{className:"h-4 w-4 text-blue-500 mr-1"}),(0,t.jsxs)("span",{children:["共 ",f," 頁"]})]}),(0,t.jsx)("div",{className:"flex items-center space-x-4 mt-2"}),(0,t.jsx)(c.P.button,{onClick:()=>F(e=>Math.max(e-.1,.5)),className:"px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded-md text-gray-700 text-sm",whileHover:{scale:1.05},whileTap:{scale:.95},children:"縮小"}),(0,t.jsxs)("span",{className:"text-gray-600 font-medium text-sm",children:[Math.round(100*T),"%"]}),(0,t.jsx)(c.P.button,{onClick:()=>F(e=>Math.min(e+.1,2)),className:"px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded-md text-gray-700 text-sm",whileHover:{scale:1.05},whileTap:{scale:.95},children:"放大"})]})]})})})}}}]);