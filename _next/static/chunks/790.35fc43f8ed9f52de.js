"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[790],{6790:(e,a,t)=>{t.r(a),t.d(a,{default:()=>P});var s=t(5155),i=t(2115),r=t(3824),l=t(5404),n=t(9280);t(8851),t(2465);var c=t(1736),d=t(5084),o=t(6648),x=t(1767),m=t(9621),h=t(7434),p=t(7924),u=t(3786),y=t(1243),j=t(8538),b=t(2355),g=t(3052),N=t(4881),w=t(9964),f=t(6874),v=t.n(f);function P(e){let{url:a,teaching_plan_link:f}=e,[P,k]=(0,i.useState)(),[A,C]=(0,i.useState)(1),[S,L]=(0,i.useState)(null),[T,F]=(0,i.useState)(!1),[D,H]=(0,i.useState)(1),[E,_]=(0,i.useState)(null),[M,I]=(0,i.useState)(null),[O,W]=(0,i.useState)(!0);return((0,i.useEffect)(()=>{r.EA.workerSrc=new t.U(t(7266)).toString(),F(!0),(async()=>{try{W(!0);let e=await fetch(a),t=e.headers.get("Content-Type")||"";if(I(t),!t.includes("application/pdf")){let a=await e.text();_(a),t.includes("text/html")||t.includes("text/plain")||L("不支援的檔案類型: ".concat(t))}}catch(e){console.error("Error fetching content:",e),L("無法載入內容")}finally{W(!1)}})()},[a]),!T||O)?(0,s.jsxs)(c.P.div,{className:"flex flex-col items-center justify-center py-20",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[(0,s.jsx)("div",{className:"relative mb-6",children:(0,s.jsx)(c.P.div,{animate:{y:[-2,2,-2],scale:[1,1.1,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:(0,s.jsx)(o.A,{className:"h-8 w-8 text-blue-500"})})}),(0,s.jsx)(c.P.div,{className:"flex items-center space-x-1",animate:"visible",initial:"hidden",variants:{visible:{transition:{staggerChildren:.1}}},children:(0,s.jsx)(c.P.p,{className:"text-blue-500 font-medium",animate:{opacity:[0,1,0]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"},children:"確認教學計劃表狀態中"})}),(0,s.jsx)(c.P.p,{className:"text-sm text-gray-400 mt-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:1},children:"可能需要一點時間"})]}):E&&M?(0,s.jsx)(d.N,{mode:"wait",children:(0,s.jsxs)(c.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.4},children:[(0,s.jsxs)("div",{className:"rounded-lg overflow-hidden border border-amber-200 mb-4",children:[(0,s.jsxs)("div",{className:"bg-amber-50 p-4 flex items-center gap-3",children:[(0,s.jsx)(x.A,{className:"text-amber-500 h-5 w-5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-amber-800 font-medium",children:"伺服器傳回非 PDF 內容"}),(0,s.jsxs)("p",{className:"text-amber-700 text-sm",children:["內容類型: ",M]})]})]}),M.includes("text/html")?(0,s.jsxs)(c.P.div,{className:"bg-white p-4 border-t border-amber-100",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:[(0,s.jsxs)("div",{className:"mb-3 flex items-center",children:[(0,s.jsx)(m.A,{className:"text-blue-500 h-4 w-4 mr-2"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"HTML 內容預覽"})]}),(0,s.jsx)("div",{className:"border border-gray-200 rounded-md p-4 bg-gray-50 overflow-auto max-h-[500px]",children:(0,s.jsx)("iframe",{srcDoc:E,className:"w-full h-[400px] border-0",title:"Response Content"})}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsxs)("details",{className:"bg-gray-50 rounded-md",children:[(0,s.jsx)("summary",{className:"p-2 cursor-pointer text-sm text-gray-700 font-medium",children:"查看原始 HTML"}),(0,s.jsx)("pre",{className:"text-xs p-3 overflow-auto max-h-[300px] bg-gray-100 border-t border-gray-200 rounded-b-md",children:E})]})})]}):(0,s.jsxs)(c.P.div,{className:"bg-white p-4 border-t border-amber-100",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:[(0,s.jsxs)("div",{className:"mb-3 flex items-center",children:[(0,s.jsx)(h.A,{className:"text-blue-500 h-4 w-4 mr-2"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"文字內容"})]}),(0,s.jsx)("pre",{className:"bg-gray-50 p-4 rounded-md overflow-auto text-sm text-gray-700 max-h-[500px] border border-gray-200",children:E})]})]}),(0,s.jsxs)(c.P.div,{className:"bg-blue-50 p-4 rounded-lg border border-blue-100 text-blue-700 mb-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:[(0,s.jsx)("p",{className:"text-sm",children:"可能的原因："}),(0,s.jsxs)("ul",{className:"list-disc pl-5 mt-2 text-sm space-y-1",children:[(0,s.jsx)("li",{children:"該課程沒有上傳，或不需要上傳課程計畫表"}),(0,s.jsx)("li",{children:"教學計畫表不存在或已移除"}),(0,s.jsx)("li",{children:"無法解析教學計畫表的檔案格式，有可能教師上傳了錯誤自編的檔案，或是非 PDF 格式"}),(0,s.jsx)("li",{children:"校務系統暫時的故障"})]}),(0,s.jsxs)("div",{className:"mt-3 text-sm flex items-center space-x-1",children:[(0,s.jsx)("p",{children:"如欲確認詳細狀況，建議使用以下連結確認："}),(0,s.jsxs)(v(),{href:"https://sys.ndhu.edu.tw/aa/class/course/",target:"_blank",rel:"noopener noreferrer",className:"underline flex items-center space-x-1",children:[(0,s.jsx)(p.A,{className:"h-4 w-4 inline-block"}),"東華課程查詢系統"]}),"、",(0,s.jsxs)(v(),{href:f,target:"_blank",rel:"noopener noreferrer",className:"underline flex items-center space-x-1",children:[(0,s.jsx)(u.A,{className:"h-4 w-4 inline-block"}),"教學計畫表連結"]})]})]})]})}):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(d.N,{mode:"wait",children:S?(0,s.jsxs)(c.P.div,{className:"text-center py-8 px-4 bg-red-50 rounded-lg border border-red-100 text-red-600 shadow-sm",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},children:[(0,s.jsx)(y.A,{className:"h-12 w-12 mx-auto mb-3 text-red-500"}),(0,s.jsx)("p",{className:"text-lg font-medium mb-2",children:"載入 PDF 時發生錯誤"}),(0,s.jsx)("p",{children:"請確認連結是否有效，或稍後再試。"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.P.div,{className:"sticky top-20 z-30 mx-auto w-fit mb-4",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.3},children:(0,s.jsxs)("div",{className:"bg-white/90 backdrop-blur-sm rounded-full px-4 py-2 shadow-md border border-gray-200 flex items-center space-x-3",children:[(0,s.jsx)(c.P.button,{onClick:()=>C(1),className:"p-2 rounded-full hover:bg-gray-100 text-gray-700 cursor-pointer",whileHover:{scale:1.1},whileTap:{scale:.9},disabled:1===A,children:(0,s.jsx)(j.A,{className:"h-4 w-4"})}),(0,s.jsx)(c.P.button,{onClick:()=>{A>1&&C(A-1)},className:"p-2 rounded-full hover:bg-gray-100 text-gray-700 cursor-pointer",whileHover:{scale:1.1},whileTap:{scale:.9},disabled:1===A,children:(0,s.jsx)(b.A,{className:"h-5 w-5"})}),(0,s.jsxs)("div",{className:"text-sm font-medium text-gray-700 min-w-16 text-center",children:[A," / ",P||"--"]}),(0,s.jsx)(c.P.button,{onClick:()=>{P&&A<P&&C(A+1)},className:"p-2 rounded-full hover:bg-gray-100 text-gray-700 cursor-pointer",whileHover:{scale:1.1},whileTap:{scale:.9},disabled:!P||A===P,children:(0,s.jsx)(g.A,{className:"h-5 w-5"})}),(0,s.jsx)(c.P.button,{onClick:()=>P&&C(P),className:"p-2 rounded-full hover:bg-gray-100 text-gray-700 cursor-pointer",whileHover:{scale:1.1},whileTap:{scale:.9},disabled:!P||A===P,children:(0,s.jsx)(N.A,{className:"h-4 w-4"})})]})}),(0,s.jsx)(c.P.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6},className:"flex flex-col items-center",children:(0,s.jsx)(l.A,{file:a,onLoadSuccess:function(e){let{numPages:a}=e;k(a),W(!1)},onLoadError:function(e){console.error("PDF loading error:",e),L("無法載入 PDF 文件"),W(!1)},className:"flex flex-col items-center",loading:(0,s.jsxs)(c.P.div,{className:"flex flex-col items-center justify-center py-20",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[(0,s.jsx)("div",{className:"relative mb-6",children:(0,s.jsx)(c.P.div,{animate:{y:[-3,3,-3],scale:[1,1.1,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:(0,s.jsx)(w.A,{className:"h-8 w-8 text-blue-500 relative z-10"})})}),(0,s.jsxs)("div",{className:"flex flex-col items-center space-y-2",children:[(0,s.jsx)(c.P.p,{className:"text-blue-500 font-medium flex items-center",animate:{opacity:[0,1,0]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut",times:[0,.5,1]},children:"載入 PDF 中"}),(0,s.jsx)(c.P.p,{className:"text-sm text-gray-400",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:"正在準備文件內容"})]})]}),error:(0,s.jsxs)(c.P.div,{className:"text-center py-10 text-red-500",initial:{opacity:0},animate:{opacity:1},children:[(0,s.jsx)(y.A,{className:"h-8 w-8 mx-auto mb-2"}),"無法載入 PDF，請檢查連結是否有效"]}),children:(0,s.jsx)(d.N,{mode:"wait",children:(0,s.jsx)(c.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:(0,s.jsx)(n.A,{pageNumber:A,className:"mb-4 shadow-lg rounded overflow-hidden",width:window.innerWidth>768?800*D:(window.innerWidth-40)*D,renderTextLayer:!0,renderAnnotationLayer:!0,scale:D})},A)})})}),P&&P>0&&(0,s.jsx)(c.P.div,{className:"text-center text-sm text-gray-500 mt-2 mb-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:(0,s.jsxs)("div",{className:"flex items-center justify-center space-x-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)(h.A,{className:"h-4 w-4 text-blue-500"}),(0,s.jsxs)("span",{children:["共 ",P," 頁"]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 bg-gray-50 rounded-lg px-3 py-1.5 border border-gray-200",children:[(0,s.jsx)(c.P.button,{onClick:()=>H(e=>Math.max(e-.1,.5)),className:"p-1.5 hover:bg-gray-200 rounded-md text-gray-700 cursor-pointer",whileHover:{scale:1.05},whileTap:{scale:.95},title:"縮小",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)("line",{x1:"5",y1:"12",x2:"19",y2:"12"})})}),(0,s.jsxs)("span",{className:"text-gray-600 font-medium min-w-[3.5rem]",children:[Math.round(100*D),"%"]}),(0,s.jsx)(c.P.button,{onClick:()=>H(e=>Math.min(e+.1,2)),className:"p-1.5 hover:bg-gray-200 rounded-md text-gray-700 cursor-pointer",whileHover:{scale:1.05},whileTap:{scale:.95},title:"放大",children:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),(0,s.jsx)("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]})]})})]})})})}}}]);