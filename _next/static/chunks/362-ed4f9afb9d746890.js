"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[362],{4186:(e,s,t)=>{t.d(s,{A:()=>r});let r=(0,t(9946).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},4357:(e,s,t)=>{t.d(s,{A:()=>r});let r=(0,t(9946).A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},4362:(e,s,t)=>{t.d(s,{A:()=>_});var r=t(5155),a=t(2115),i=t(9932),l=t(6072),o=t(7287),n=t(4186),c=t(9946);let d=(0,c.A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var m=t(6874),u=t.n(m);let x=[{period:1,time:"06:10~07:00"},{period:2,time:"07:10~08:00"},{period:3,time:"08:10~09:00"},{period:4,time:"09:10~10:00"},{period:5,time:"10:10~11:00"},{period:6,time:"11:10~12:00"},{period:7,time:"12:10~13:00"},{period:8,time:"13:10~14:00"},{period:9,time:"14:10~15:00"},{period:10,time:"15:10~16:00"},{period:11,time:"16:10~17:00"},{period:12,time:"17:10~18:00"},{period:13,time:"18:10~19:00"},{period:14,time:"19:10~20:00"},{period:15,time:"20:10~21:00"},{period:16,time:"21:10~22:00"}],h=[{key:"一",name:"週一"},{key:"二",name:"週二"},{key:"三",name:"週三"},{key:"四",name:"週四"},{key:"五",name:"週五"}];function g(e){let{courses:s,semester:t,onRemoveCourse:a,isShared:l=!1}=e,o={};h.forEach(e=>{o[e.key]={},x.forEach(s=>{o[e.key][s.period]=null})}),s.forEach(e=>{e.class_time.forEach(s=>{let t=Number(s.period);o[s.day]&&x.some(e=>e.period===t)&&(o[s.day][t]=e)})});let c={};return h.forEach(e=>{c[e.key]={};let s=0;for(;s<x.length;){let t=x[s].period,r=o[e.key][t];if(r){let a=1,i=s+1;for(;i<x.length;){let s=x[i].period,t=o[e.key][s];if(t&&t.course_id===r.course_id)a++,i++;else break}c[e.key][t]={course:r,rowSpan:a,isHidden:!1};for(let t=1;t<a;t++){let a=x[s+t].period;c[e.key][a]={course:r,rowSpan:1,isHidden:!0}}s+=a}else s++}}),(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200/50 overflow-hidden",children:[(0,r.jsx)("div",{className:"bg-indigo-50 px-6 py-4 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)(n.A,{className:"w-5 h-5 text-indigo-600"}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"週課表"})]}),s.length>0&&(0,r.jsxs)("div",{className:"text-sm text-indigo-700 font-medium",children:["共 ",s.length," 門課程"]})]})}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full border-collapse bg-white rounded-lg overflow-hidden",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-indigo-50",children:[(0,r.jsx)("th",{className:"border border-gray-200 px-3 py-2 text-sm font-semibold text-indigo-800 w-24",children:"時段"}),h.map(e=>(0,r.jsx)("th",{className:"border border-gray-200 px-3 py-2 text-sm font-semibold text-indigo-800 min-w-[160px]",children:e.name},e.key))]})}),(0,r.jsx)("tbody",{children:x.map(e=>(0,r.jsxs)("tr",{className:"bg-gray-50/30",children:[(0,r.jsxs)("td",{className:"border border-gray-200 px-2 py-1 bg-indigo-50/50 text-center",children:[(0,r.jsx)("span",{className:"font-medium text-sm",children:e.period}),(0,r.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:e.time})]}),h.map(s=>{let o=c[s.key][e.period];return(null==o?void 0:o.isHidden)?null:(0,r.jsx)("td",{className:"border border-gray-200 px-1 py-2 text-center align-middle relative",rowSpan:(null==o?void 0:o.rowSpan)||1,style:{height:(null==o?void 0:o.rowSpan)?"".concat(4*o.rowSpan,"rem"):"4rem"},children:(null==o?void 0:o.course)?(0,r.jsxs)(i.P.div,{className:"flex flex-col items-center justify-center h-full w-full absolute top-0 left-0 p-2 bg-indigo-50 hover:bg-indigo-100 border border-indigo-200 cursor-pointer rounded-lg group transition-colors",whileHover:{scale:1.02},whileTap:{scale:.98},transition:{duration:.2},children:[(0,r.jsxs)(u(),{href:"/course/".concat(t,"/").concat(o.course.course_id),className:"w-full h-full flex flex-col items-center justify-center",children:[(0,r.jsx)("div",{className:"font-medium text-indigo-900 text-sm text-center leading-tight",children:o.course.course_name.length>(o.rowSpan>1?20:10)?o.course.course_name.substring(0,o.rowSpan>1?20:10)+"...":o.course.course_name}),o.course.classroom.length>0&&(0,r.jsx)("div",{className:"text-xs text-indigo-700 mt-1",children:o.course.classroom[0]}),o.rowSpan>1&&(0,r.jsxs)("div",{className:"text-xs text-indigo-600 mt-1 opacity-75",children:[o.rowSpan," 節連堂"]})]}),!l&&(0,r.jsx)(i.P.button,{onClick:e=>{e.preventDefault(),e.stopPropagation(),a(o.course.course_id)},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200 hover:bg-red-600 shadow-sm z-10",whileHover:{scale:1.1},whileTap:{scale:.9},children:(0,r.jsx)(d,{className:"w-3 h-3"})})]}):(0,r.jsx)("div",{className:"h-full w-full flex items-center justify-center text-gray-300 hover:bg-gray-50 transition-colors rounded-sm group",children:(0,r.jsx)("div",{className:"text-xs opacity-0 group-hover:opacity-50 transition-opacity",children:"空堂"})})},s.key)})]},e.period))})]})}),(0,r.jsx)("div",{className:"bg-indigo-50/50 px-6 py-4 border-t border-gray-200",children:(0,r.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4 text-gray-700",children:[(0,r.jsxs)("span",{className:"font-medium",children:["共 ",s.length," 門課程"]}),(0,r.jsxs)("span",{children:["總學分：",s.reduce((e,s)=>e+(parseFloat(s.credits.split("/")[0])||0),0)," 學分"]})]}),s.length>0&&(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"* 僅顯示週一至週五，第1-16節"})]})})]})}var p=t(760),y=t(9074),f=t(6474);function b(e){let{availableSemesters:s,selectedSemester:t,onSemesterChange:l}=e,[o,n]=(0,a.useState)(!1);if(0===s.length)return(0,r.jsxs)("div",{className:"flex items-center justify-center p-4 bg-gray-100 rounded-lg",children:[(0,r.jsx)(y.A,{className:"w-5 h-5 text-gray-400 mr-2"}),(0,r.jsx)("span",{className:"text-gray-500",children:"尚未加入任何課程"})]});let c=[...s].sort((e,s)=>{let[t,r]=e.split("-").map(Number),[a,i]=s.split("-").map(Number);return a===t?i-r:a-t});return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)(i.P.button,{onClick:()=>n(!o),className:"flex items-center justify-between w-full px-4 py-3 bg-white border border-gray-200 rounded-lg shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",whileHover:{scale:1.01},whileTap:{scale:.99},children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(y.A,{className:"w-5 h-5 text-blue-600 mr-3"}),(0,r.jsxs)("div",{className:"text-left",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:t?"".concat(t," 學期"):"選擇學期"}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:[s.length," 個學期有課程"]})]})]}),(0,r.jsx)(i.P.div,{animate:{rotate:180*!!o},transition:{duration:.2},children:(0,r.jsx)(f.A,{className:"w-5 h-5 text-gray-400"})})]}),(0,r.jsx)(p.N,{children:o&&(0,r.jsx)(i.P.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},className:"absolute z-20 w-full mt-2 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:(0,r.jsx)("div",{className:"py-1",children:c.map(e=>(0,r.jsx)(i.P.button,{onClick:()=>{l(e),n(!1)},className:"w-full text-left px-4 py-3 hover:bg-blue-50 transition-colors ".concat(t===e?"bg-blue-100 text-blue-700 font-medium":"text-gray-700"),whileHover:{backgroundColor:t===e?"#dbeafe":"#f8fafc"},children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("span",{children:[e," 學期"]}),t===e&&(0,r.jsx)(i.P.div,{initial:{scale:0},animate:{scale:1},className:"w-2 h-2 bg-blue-600 rounded-full"})]})},e))})})}),o&&(0,r.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>n(!1)})]})}let v=(0,c.A)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);var j=t(4357);let N=(0,c.A)("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);var w=t(5040);let k="ndhu-course-user-name",S=e=>fetch(e).then(e=>e.json());function _(e){let{sharedName:s,sharedSemester:t,sharedCourseIds:n}=e,[c,m]=(0,a.useState)([]),[u,x]=(0,a.useState)(""),[h,p]=(0,a.useState)([]),[f,_]=(0,a.useState)(!0),[C,A]=(0,a.useState)(""),[P,E]=(0,a.useState)(!1),[I]=(0,a.useState)(!!s),[D,H]=(0,a.useState)(!1),T=(0,a.useCallback)(async()=>{if(!u){_(!1);return}try{if(_(!0),I)return;let e=o.P.getSemesterCourses(u);p(e);let s=o.P.getAvailableSemesters();m(s)}catch(e){console.error("Error loading schedule data:",e),p([])}finally{_(!1)}},[u,I]),{data:F,isLoading:z}=(0,l.Ay)(u&&h.length>0&&I?h.map(e=>"https://yc97463.github.io/ndhu-course-crawler/".concat(u,"/course/").concat(e.course_id,".json")):null,e=>Promise.all(e.map(e=>S(e))),{revalidateOnFocus:!1,revalidateOnReconnect:!1,dedupingInterval:6e4}),O=(0,a.useCallback)(e=>e.map(e=>{var s;let t=e.class_time||[],r=t.map(e=>{if("object"==typeof e&&null!==e){var s,t;return{day:(null===(s=e.day)||void 0===s?void 0:s.toString())||"",period:(null===(t=e.period)||void 0===t?void 0:t.toString())||""}}if("string"==typeof e){let[s,t]=e.split("-");return{day:s||"",period:t||""}}return e});return console.log("Original class_time:",t),console.log("Formatted class_time:",r),{course_id:e.course_id,course_name:e.course_name,english_course_name:e.english_course_name||"",teacher:Array.isArray(e.teacher)?e.teacher:[e.teacher],classroom:Array.isArray(e.classroom)?e.classroom:[e.classroom],credits:(null===(s=e.credits)||void 0===s?void 0:s.toString())||"",class_time:r,semester:e.semester||u,departments:e.departments||[]}}),[u]);(0,a.useEffect)(()=>{if(!I){let e=localStorage.getItem(k);e&&A(e);let s=o.P.getAvailableSemesters();m(s),s.length>0&&x([...s].sort((e,s)=>{let[t,r]=e.split("-").map(Number),[a,i]=s.split("-").map(Number);return a===t?i-r:a-t})[0])}},[I]),(0,a.useEffect)(()=>{u&&T()},[u,T]),(0,a.useEffect)(()=>{F&&I&&(p(O(F)),_(!1))},[F,I,O]),(0,a.useEffect)(()=>{I&&s&&t&&n&&(A(s),x(t),m([t]),p(n.map(e=>({course_id:e,course_name:"",english_course_name:"",teacher:[],classroom:[],credits:"",class_time:[],semester:t,departments:[]}))))},[I,s,t,n]);let R=e=>{A(e),localStorage.setItem(k,e)},M=e=>{if(u){o.P.removeCourse(u,e);let s=o.P.getSemesterCourses(u);if(p(s),0===s.length){let e=o.P.getAvailableSemesters();m(e),e.length>0?x([...e].sort((e,s)=>{let[t,r]=e.split("-").map(Number),[a,i]=s.split("-").map(Number);return a===t?i-r:a-t})[0]):x("")}}},V=()=>{if(!u||0===h.length)return"";let e=h.map(e=>e.course_id).join(","),s=window.location.origin,t=btoa(encodeURIComponent(C||"anonymous")).replace(/=/g,"");return"".concat(s,"/schedule/share?name=").concat(t,"&semester=").concat(u,"&courses=").concat(e)},q=async()=>{let e=V();if(e)try{await navigator.clipboard.writeText(e),E(!0),setTimeout(()=>E(!1),2e3)}catch(e){console.error("Failed to copy link:",e)}};return f||z?(console.log("Rendering loading state",{isLoading:f,isCourseLoading:z}),(0,r.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,r.jsxs)("div",{className:"text-center py-16",children:[(0,r.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-indigo-100 rounded-full mb-4",children:(0,r.jsx)("div",{className:"animate-spin w-8 h-8 border-4 border-indigo-600 border-t-transparent rounded-full"})}),(0,r.jsx)("p",{className:"text-gray-600 font-medium",children:"載入時刻表中..."})]})})})):(console.log("Rendering main view with state:",{isSharedView:I,selectedSemester:u,courses:h.length,userName:C,isLoading:f}),(0,r.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)(i.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-12",children:[(0,r.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-indigo-100 rounded-full mb-4",children:(0,r.jsx)(y.A,{className:"w-8 h-8 text-indigo-600"})}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-4 flex items-center justify-center",children:I?"".concat(C,"的課表"):D?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{type:"text",value:C,onChange:e=>R(e.target.value),onBlur:()=>H(!1),onKeyDown:e=>{"Enter"===e.key&&H(!1)},autoFocus:!0,className:"w-32 px-2 py-1 border border-indigo-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-center text-4xl font-bold text-gray-900"}),"的課表"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("span",{onClick:()=>H(!0),className:"group relative inline-block cursor-pointer py-2",children:[(0,r.jsx)("span",{className:"text-4xl font-bold text-gray-900",children:C||"我"}),(0,r.jsx)("div",{className:"absolute inset-0 border-2 border-dashed border-indigo-200 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity"}),(0,r.jsx)(v,{className:"w-4 h-4 text-indigo-500 absolute -left-6 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity"})]}),"的課表"]})}),(0,r.jsx)("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"管理您的課程安排，掌握學習節奏"})]})]}),!I&&(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsx)("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200/50 p-6",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,r.jsx)("div",{className:"flex-1 max-w-md",children:(0,r.jsx)(b,{availableSemesters:c,selectedSemester:u,onSemesterChange:e=>{x(e),localStorage.setItem("ndhu-course-selected-semester",e),p([]),T()}})}),u&&h.length>0&&(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(i.P.button,{onClick:q,className:"inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white/80 backdrop-blur-sm border border-gray-200 rounded-lg hover:bg-white hover:border-gray-300 shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200",whileHover:{scale:1.02},whileTap:{scale:.98},children:P?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(j.A,{className:"w-4 h-4 mr-2 text-indigo-600"}),"已複製！"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(N,{className:"w-4 h-4 mr-2 text-indigo-600"}),"分享課表"]})}),(0,r.jsxs)(i.P.button,{onClick:()=>{u&&confirm("確定要清空 ".concat(u," 學期的所有課程嗎？"))&&(o.P.clearSemester(u),T())},className:"inline-flex items-center px-4 py-2 text-sm font-medium text-red-700 bg-red-50 border border-red-200 rounded-lg hover:bg-red-100 hover:border-red-300 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-all duration-200",whileHover:{scale:1.02},whileTap:{scale:.98},children:[(0,r.jsx)(d,{className:"w-4 h-4 mr-2"}),"清空學期"]})]})]})})}),(0,r.jsx)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.4},children:0!==c.length||I?(0,r.jsx)(g,{courses:h,semester:u,onRemoveCourse:M,isShared:I}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"text-center py-12 bg-white rounded-2xl shadow-sm border border-gray-200/50 mb-8",children:[(0,r.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gray-100 rounded-full mb-4",children:(0,r.jsx)(w.A,{className:"w-8 h-8 text-gray-400"})}),(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"還沒有任何課程"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"請到課程詳細頁面將課程加入到時刻表中"}),(0,r.jsx)(i.P.a,{href:"/",className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 active:bg-indigo-800 shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200",whileHover:{scale:1.02},whileTap:{scale:.98},children:"瀏覽課程"})]}),(0,r.jsx)(g,{courses:[],semester:"",onRemoveCourse:M,isShared:I})]})}),c.length>0&&(0,r.jsxs)(i.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.6},className:"mt-8 bg-white rounded-2xl shadow-sm border border-gray-200/50 p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"使用說明"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-600",children:[(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-indigo-500 rounded-full mt-2 flex-shrink-0"}),(0,r.jsx)("span",{children:"點擊課程方塊可以查看課程詳細資訊"})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-red-500 rounded-full mt-2 flex-shrink-0"}),(0,r.jsx)("span",{children:"滑鼠移到課程上會顯示移除按鈕"})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-emerald-500 rounded-full mt-2 flex-shrink-0"}),(0,r.jsx)("span",{children:"可以切換不同學期查看時刻表"})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-amber-500 rounded-full mt-2 flex-shrink-0"}),(0,r.jsx)("span",{children:"資料會自動儲存在瀏覽器中"})]})]})]})]})}))}},7287:(e,s,t)=>{t.d(s,{P:()=>a});let r="ndhu-course-schedule";class a{static getScheduleData(){try{let e=localStorage.getItem(r);if(!e)return{};let s=JSON.parse(e);if("object"!=typeof s||null===s)return console.error("Invalid schedule data format"),{};return s}catch(e){return console.error("Error reading schedule data:",e),{}}}static saveScheduleData(e){try{if("object"!=typeof e||null===e){console.error("Invalid schedule data format");return}localStorage.setItem(r,JSON.stringify(e))}catch(e){console.error("Error saving schedule data:",e)}}static getSemesterCourses(e){let s=this.getScheduleData()[e]||[];return Array.isArray(s)?s:(console.error("Invalid courses data format"),[])}static addCourse(e,s){if(!e||!s||!s.course_id)return console.error("Invalid course data"),!1;let t=this.getScheduleData();return t[e]||(t[e]=[]),!(t[e].some(e=>e.course_id===s.course_id)||this.checkTimeConflict(e,s))&&(t[e].push(s),this.saveScheduleData(t),!0)}static removeCourse(e,s){if(!e||!s){console.error("Invalid semester or courseId");return}let t=this.getScheduleData();t[e]&&(t[e]=t[e].filter(e=>e.course_id!==s),this.saveScheduleData(t))}static isCourseInSchedule(e,s){return!!e&&!!s&&this.getSemesterCourses(e).some(e=>e.course_id===s)}static checkTimeConflict(e,s){if(!e||!s||!s.class_time)return!1;for(let t of this.getSemesterCourses(e))if(t.class_time){for(let e of s.class_time)if(e&&e.day&&e.period){for(let s of t.class_time)if(s&&s.day&&s.period&&e.day===s.day&&String(e.period)===String(s.period))return!0}}return!1}static getAvailableSemesters(){let e=this.getScheduleData();return Object.keys(e).filter(s=>{let t=e[s];return Array.isArray(t)&&t.length>0})}static clearSemester(e){if(!e)return;let s=this.getScheduleData();delete s[e],this.saveScheduleData(s)}static clearAll(){localStorage.removeItem(r)}}}}]);