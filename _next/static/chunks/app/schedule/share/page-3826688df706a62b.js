(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[730],{2898:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>x});var a=r(5155),t=r(2115),n=r(5695),c=r(4362),i=r(9932),l=r(9074),d=r(4616),o=r(7287);function m(e){let{name:s,semester:r,courses:t}=e;return(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200/50",children:[s&&(0,a.jsx)("div",{className:"flex items-center gap-2 bg-indigo-50 rounded-t-lg px-6 py-2",children:(0,a.jsxs)("span",{className:"text-xs text-indigo-700",children:[(0,a.jsx)("span",{className:"font-semibold",children:s})," 與您分享他 ",(0,a.jsx)("span",{className:"font-semibold",children:r})," 的課表"]})}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-10 h-10 bg-indigo-100 rounded-full",children:(0,a.jsx)(l.A,{className:"w-5 h-5 text-indigo-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:[r," 學期"]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["共 ",t.length," 門課程"]})]})]}),(0,a.jsxs)(i.P.button,{onClick:()=>{r&&0!==t.length&&(!(o.P.getSemesterCourses(r).length>0)||confirm("您已經有 ".concat(r," 學期的課程，加入這些課程可能會造成時間衝突。是否繼續？")))&&Promise.all(t.map(e=>fetch("https://yc97463.github.io/ndhu-course-crawler/".concat(r,"/course/").concat(e,".json")).then(e=>e.json()))).then(e=>{let s=0,a=0,t=0;e.forEach(e=>{var n;let c={course_id:e.course_id,course_name:e.course_name,english_course_name:e.english_course_name||"",teacher:Array.isArray(e.teacher)?e.teacher:[e.teacher],classroom:Array.isArray(e.classroom)?e.classroom:[e.classroom],credits:(null===(n=e.credits)||void 0===n?void 0:n.toString())||"",class_time:e.class_time.map(e=>{var s,r;return{day:(null===(s=e.day)||void 0===s?void 0:s.toString())||"",period:(null===(r=e.period)||void 0===r?void 0:r.toString())||""}}),semester:r,departments:e.departments||[]};o.P.addCourse(r,c)?s++:o.P.checkTimeConflict(r,c)?a++:t++});let n="已成功加入 ".concat(s," 門課程");a>0&&(n+="\n".concat(a," 門課程因時間衝突無法加入")),t>0&&(n+="\n".concat(t," 門課程已存在於課表中")),alert(n)}).catch(e=>{console.error("Error adding courses:",e),alert("加入課程時發生錯誤，請稍後再試。")})},className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 active:bg-indigo-800 shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200",whileHover:{scale:1.02},whileTap:{scale:.98},children:[(0,a.jsx)(d.A,{className:"w-4 h-4 mr-2"}),"加到我的課表"]})]})]})})}function u(){let e=(0,n.useSearchParams)(),[s,r]=(0,t.useState)(null);return((0,t.useEffect)(()=>{let s=e.get("name"),a=e.get("semester"),t=e.get("courses");if(!s||!a||!t){r(null);return}try{let e=decodeURIComponent(atob(s+"=".repeat((4-s.length%4)%4)));r({name:s,semester:a,courses:t.split(","),decodedName:e})}catch(e){r({name:s,semester:a,courses:t.split(","),decodedName:"",error:String(e)})}},[e]),null===s)?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsx)("div",{className:"text-center py-16",children:(0,a.jsx)("p",{className:"text-gray-600 font-medium",children:"無效的分享連結"})})})}):s.error?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsxs)("div",{className:"text-center py-16",children:[(0,a.jsx)("p",{className:"text-gray-600 font-medium",children:"無效的分享連結"}),(0,a.jsx)("p",{className:"text-gray-500",children:s.error})]})})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,a.jsx)(m,{name:s.decodedName,semester:s.semester,courses:s.courses}),(0,a.jsx)(c.A,{sharedName:s.decodedName,sharedSemester:s.semester,sharedCourseIds:s.courses})]})})}function x(){return(0,a.jsx)(t.Suspense,{fallback:(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsxs)("div",{className:"text-center py-16",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-indigo-100 rounded-full mb-4",children:(0,a.jsx)("div",{className:"animate-spin w-8 h-8 border-4 border-indigo-600 border-t-transparent rounded-full"})}),(0,a.jsx)("p",{className:"text-gray-600 font-medium",children:"載入課表中..."})]})})}),children:(0,a.jsx)(u,{})})}},3381:(e,s,r)=>{Promise.resolve().then(r.bind(r,2898))},4616:(e,s,r)=>{"use strict";r.d(s,{A:()=>a});let a=(0,r(9946).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},5695:(e,s,r)=>{"use strict";var a=r(8999);r.o(a,"useParams")&&r.d(s,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(s,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(s,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(s,{useSearchParams:function(){return a.useSearchParams}})}},e=>{var s=s=>e(e.s=s);e.O(0,[341,874,938,362,441,684,358],()=>s(3381)),_N_E=e.O()}]);