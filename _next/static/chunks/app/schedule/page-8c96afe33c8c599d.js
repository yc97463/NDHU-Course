(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[826],{4171:(e,s,t)=>{Promise.resolve().then(t.bind(t,8701))},4186:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(9946).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},7287:(e,s,t)=>{"use strict";t.d(s,{P:()=>i});let r="ndhu-course-schedule";class i{static getScheduleData(){try{let e=localStorage.getItem(r);return e?JSON.parse(e):{}}catch(e){return console.error("Error reading schedule data:",e),{}}}static saveScheduleData(e){try{localStorage.setItem(r,JSON.stringify(e))}catch(e){console.error("Error saving schedule data:",e)}}static getSemesterCourses(e){return this.getScheduleData()[e]||[]}static addCourse(e,s){let t=this.getScheduleData();return t[e]||(t[e]=[]),!(t[e].some(e=>e.course_id===s.course_id)||this.checkTimeConflict(e,s))&&(t[e].push(s),this.saveScheduleData(t),!0)}static removeCourse(e,s){let t=this.getScheduleData();t[e]&&(t[e]=t[e].filter(e=>e.course_id!==s),this.saveScheduleData(t))}static isCourseInSchedule(e,s){return this.getSemesterCourses(e).some(e=>e.course_id===s)}static checkTimeConflict(e,s){for(let t of this.getSemesterCourses(e))for(let e of s.class_time)for(let s of t.class_time)if(e.day===s.day&&String(e.period)===String(s.period))return!0;return!1}static getAvailableSemesters(){let e=this.getScheduleData();return Object.keys(e).filter(s=>e[s].length>0)}static clearSemester(e){let s=this.getScheduleData();delete s[e],this.saveScheduleData(s)}static clearAll(){localStorage.removeItem(r)}}},8701:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>w});var r=t(5155),i=t(6072),a=t(2115),l=t(9932),n=t(7287),o=t(4186),d=t(9946);let c=(0,d.A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var m=t(6874),x=t.n(m);let h=[{period:1,time:"06:10~07:00"},{period:2,time:"07:10~08:00"},{period:3,time:"08:10~09:00"},{period:4,time:"09:10~10:00"},{period:5,time:"10:10~11:00"},{period:6,time:"11:10~12:00"},{period:7,time:"12:10~13:00"},{period:8,time:"13:10~14:00"},{period:9,time:"14:10~15:00"},{period:10,time:"15:10~16:00"},{period:11,time:"16:10~17:00"},{period:12,time:"17:10~18:00"},{period:13,time:"18:10~19:00"},{period:14,time:"19:10~20:00"},{period:15,time:"20:10~21:00"},{period:16,time:"21:10~22:00"}],u=[{key:"一",name:"週一"},{key:"二",name:"週二"},{key:"三",name:"週三"},{key:"四",name:"週四"},{key:"五",name:"週五"}];function g(e){let{courses:s,semester:t,onRemoveCourse:i}=e,a={};u.forEach(e=>{a[e.key]={},h.forEach(s=>{a[e.key][s.period]=null})}),s.forEach(e=>{e.class_time.forEach(s=>{let t=Number(s.period);a[s.day]&&h.some(e=>e.period===t)&&(a[s.day][t]=e)})});let n={};return u.forEach(e=>{n[e.key]={};let s=0;for(;s<h.length;){let t=h[s].period,r=a[e.key][t];if(r){let i=1,l=s+1;for(;l<h.length;){let s=h[l].period,t=a[e.key][s];if(t&&t.course_id===r.course_id)i++,l++;else break}n[e.key][t]={course:r,rowSpan:i,isHidden:!1};for(let t=1;t<i;t++){let i=h[s+t].period;n[e.key][i]={course:r,rowSpan:1,isHidden:!0}}s+=i}else s++}}),(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200/50 overflow-hidden",children:[(0,r.jsx)("div",{className:"bg-indigo-50 px-6 py-4 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)(o.A,{className:"w-5 h-5 text-indigo-600"}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"週課表"})]}),s.length>0&&(0,r.jsxs)("div",{className:"text-sm text-indigo-700 font-medium",children:["共 ",s.length," 門課程"]})]})}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full border-collapse bg-white rounded-lg overflow-hidden",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-indigo-50",children:[(0,r.jsx)("th",{className:"border border-gray-200 px-3 py-2 text-sm font-semibold text-indigo-800 w-24",children:"時段"}),u.map(e=>(0,r.jsx)("th",{className:"border border-gray-200 px-3 py-2 text-sm font-semibold text-indigo-800 min-w-[160px]",children:e.name},e.key))]})}),(0,r.jsx)("tbody",{children:h.map(e=>(0,r.jsxs)("tr",{className:"bg-gray-50/30",children:[(0,r.jsxs)("td",{className:"border border-gray-200 px-2 py-1 bg-indigo-50/50 text-center",children:[(0,r.jsx)("span",{className:"font-medium text-sm",children:e.period}),(0,r.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:e.time})]}),u.map(s=>{let a=n[s.key][e.period];return(null==a?void 0:a.isHidden)?null:(0,r.jsx)("td",{className:"border border-gray-200 px-1 py-2 text-center align-middle relative",rowSpan:(null==a?void 0:a.rowSpan)||1,style:{height:(null==a?void 0:a.rowSpan)?"".concat(4*a.rowSpan,"rem"):"4rem"},children:(null==a?void 0:a.course)?(0,r.jsxs)(l.P.div,{className:"flex flex-col items-center justify-center h-full w-full absolute top-0 left-0 p-2 bg-indigo-50 hover:bg-indigo-100 border border-indigo-200 cursor-pointer rounded-lg group transition-colors",whileHover:{scale:1.02},whileTap:{scale:.98},transition:{duration:.2},children:[(0,r.jsxs)(x(),{href:"/course/".concat(t,"/").concat(a.course.course_id),className:"w-full h-full flex flex-col items-center justify-center",children:[(0,r.jsx)("div",{className:"font-medium text-indigo-900 text-sm text-center leading-tight",children:a.course.course_name.length>(a.rowSpan>1?20:10)?a.course.course_name.substring(0,a.rowSpan>1?20:10)+"...":a.course.course_name}),a.course.classroom.length>0&&(0,r.jsx)("div",{className:"text-xs text-indigo-700 mt-1",children:a.course.classroom[0]}),a.rowSpan>1&&(0,r.jsxs)("div",{className:"text-xs text-indigo-600 mt-1 opacity-75",children:[a.rowSpan," 節連堂"]})]}),(0,r.jsx)(l.P.button,{onClick:e=>{e.preventDefault(),e.stopPropagation(),i(a.course.course_id)},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200 hover:bg-red-600 shadow-sm z-10",whileHover:{scale:1.1},whileTap:{scale:.9},children:(0,r.jsx)(c,{className:"w-3 h-3"})})]}):(0,r.jsx)("div",{className:"h-full w-full flex items-center justify-center text-gray-300 hover:bg-gray-50 transition-colors rounded-sm group",children:(0,r.jsx)("div",{className:"text-xs opacity-0 group-hover:opacity-50 transition-opacity",children:"空堂"})})},s.key)})]},e.period))})]})}),(0,r.jsx)("div",{className:"bg-indigo-50/50 px-6 py-4 border-t border-gray-200",children:(0,r.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4 text-gray-700",children:[(0,r.jsxs)("span",{className:"font-medium",children:["共 ",s.length," 門課程"]}),(0,r.jsxs)("span",{children:["總學分：",s.reduce((e,s)=>e+(parseFloat(s.credits.split("/")[0])||0),0)," 學分"]})]}),s.length>0&&(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"* 僅顯示週一至週五，第1-16節"})]})})]})}var p=t(760),f=t(9074),y=t(6474);function b(e){let{availableSemesters:s,selectedSemester:t,onSemesterChange:i}=e,[n,o]=(0,a.useState)(!1);if(0===s.length)return(0,r.jsxs)("div",{className:"flex items-center justify-center p-4 bg-gray-100 rounded-lg",children:[(0,r.jsx)(f.A,{className:"w-5 h-5 text-gray-400 mr-2"}),(0,r.jsx)("span",{className:"text-gray-500",children:"尚未加入任何課程"})]});let d=[...s].sort((e,s)=>{let[t,r]=e.split("-").map(Number),[i,a]=s.split("-").map(Number);return i===t?a-r:i-t});return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)(l.P.button,{onClick:()=>o(!n),className:"flex items-center justify-between w-full px-4 py-3 bg-white border border-gray-200 rounded-lg shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",whileHover:{scale:1.01},whileTap:{scale:.99},children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(f.A,{className:"w-5 h-5 text-blue-600 mr-3"}),(0,r.jsxs)("div",{className:"text-left",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:t?"".concat(t," 學期"):"選擇學期"}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:[s.length," 個學期有課程"]})]})]}),(0,r.jsx)(l.P.div,{animate:{rotate:180*!!n},transition:{duration:.2},children:(0,r.jsx)(y.A,{className:"w-5 h-5 text-gray-400"})})]}),(0,r.jsx)(p.N,{children:n&&(0,r.jsx)(l.P.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},className:"absolute z-20 w-full mt-2 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:(0,r.jsx)("div",{className:"py-1",children:d.map(e=>(0,r.jsx)(l.P.button,{onClick:()=>{i(e),o(!1)},className:"w-full text-left px-4 py-3 hover:bg-blue-50 transition-colors ".concat(t===e?"bg-blue-100 text-blue-700 font-medium":"text-gray-700"),whileHover:{backgroundColor:t===e?"#dbeafe":"#f8fafc"},children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("span",{children:[e," 學期"]}),t===e&&(0,r.jsx)(l.P.div,{initial:{scale:0},animate:{scale:1},className:"w-2 h-2 bg-blue-600 rounded-full"})]})},e))})})}),n&&(0,r.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>o(!1)})]})}let v=(0,d.A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var j=t(5040);function N(){let[e,s]=(0,a.useState)([]),[t,i]=(0,a.useState)(""),[o,d]=(0,a.useState)([]),[m,x]=(0,a.useState)(!0);(0,a.useEffect)(()=>{h()},[]),(0,a.useEffect)(()=>{t?d(n.P.getSemesterCourses(t)):d([])},[t]);let h=()=>{x(!0);try{let e=n.P.getAvailableSemesters();if(s(e),e.length>0){let s=[...e].sort((e,s)=>{let[t,r]=e.split("-").map(Number),[i,a]=s.split("-").map(Number);return i===t?a-r:i-t});i(s[0])}}catch(e){console.error("Error loading schedule data:",e)}finally{x(!1)}},u=e=>{if(t){n.P.removeCourse(t,e);let r=n.P.getSemesterCourses(t);if(d(r),0===r.length){let e=n.P.getAvailableSemesters();s(e),e.length>0?i([...e].sort((e,s)=>{let[t,r]=e.split("-").map(Number),[i,a]=s.split("-").map(Number);return i===t?a-r:i-t})[0]):i("")}}};return m?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,r.jsxs)("div",{className:"text-center py-16",children:[(0,r.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-indigo-100 rounded-full mb-4",children:(0,r.jsx)("div",{className:"animate-spin w-8 h-8 border-4 border-indigo-600 border-t-transparent rounded-full"})}),(0,r.jsx)("p",{className:"text-gray-600 font-medium",children:"載入時刻表中..."})]})})}):(0,r.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)(l.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-12",children:[(0,r.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-indigo-100 rounded-full mb-4",children:(0,r.jsx)(f.A,{className:"w-8 h-8 text-indigo-600"})}),(0,r.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"我的課程時刻表"}),(0,r.jsx)("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"管理您的課程安排，掌握學習節奏"})]}),(0,r.jsx)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"mb-8",children:(0,r.jsx)("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200/50 p-6",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,r.jsx)("div",{className:"flex-1 max-w-md",children:(0,r.jsx)(b,{availableSemesters:e,selectedSemester:t,onSemesterChange:i})}),t&&o.length>0&&(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsxs)(l.P.button,{onClick:()=>{h()},className:"inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 active:bg-gray-100 shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200",whileHover:{scale:1.02},whileTap:{scale:.98},children:[(0,r.jsx)(v,{className:"w-4 h-4 mr-2"}),"重新整理"]}),(0,r.jsxs)(l.P.button,{onClick:()=>{t&&confirm("確定要清空 ".concat(t," 學期的所有課程嗎？"))&&(n.P.clearSemester(t),h())},className:"inline-flex items-center px-4 py-2 text-sm font-medium text-red-700 bg-red-50 border border-red-200 rounded-lg hover:bg-red-100 hover:border-red-300 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-all duration-200",whileHover:{scale:1.02},whileTap:{scale:.98},children:[(0,r.jsx)(c,{className:"w-4 h-4 mr-2"}),"清空學期"]})]})]})})}),(0,r.jsx)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.4},children:0===e.length?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"text-center py-12 bg-white rounded-2xl shadow-sm border border-gray-200/50 mb-8",children:[(0,r.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gray-100 rounded-full mb-4",children:(0,r.jsx)(j.A,{className:"w-8 h-8 text-gray-400"})}),(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"還沒有任何課程"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"請到課程詳細頁面將課程加入到時刻表中"}),(0,r.jsx)(l.P.a,{href:"/",className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 active:bg-indigo-800 shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200",whileHover:{scale:1.02},whileTap:{scale:.98},children:"瀏覽課程"})]}),(0,r.jsx)(g,{courses:[],semester:"",onRemoveCourse:u})]}):(0,r.jsx)(g,{courses:o,semester:t,onRemoveCourse:u})}),e.length>0&&(0,r.jsxs)(l.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.6},className:"mt-8 bg-white rounded-2xl shadow-sm border border-gray-200/50 p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"使用說明"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-600",children:[(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-indigo-500 rounded-full mt-2 flex-shrink-0"}),(0,r.jsx)("span",{children:"點擊課程方塊可以查看課程詳細資訊"})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-red-500 rounded-full mt-2 flex-shrink-0"}),(0,r.jsx)("span",{children:"滑鼠移到課程上會顯示移除按鈕"})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-emerald-500 rounded-full mt-2 flex-shrink-0"}),(0,r.jsx)("span",{children:"可以切換不同學期查看時刻表"})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-amber-500 rounded-full mt-2 flex-shrink-0"}),(0,r.jsx)("span",{children:"資料會自動儲存在瀏覽器中"})]})]})]})]})})}function w(){return(0,r.jsx)(i.BE,{value:{revalidateOnFocus:!1,errorRetryCount:3},children:(0,r.jsx)(N,{})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[341,874,938,441,684,358],()=>s(4171)),_N_E=e.O()}]);