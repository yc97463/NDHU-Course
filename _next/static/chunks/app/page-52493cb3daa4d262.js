(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1267:(e,t,s)=>{Promise.resolve().then(s.bind(s,2516))},2516:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var r=s(5155),a=s(6072),i=s(2115),n=s(9932),o=s(6874),l=s.n(o);function c(e){let{courses:t,semester:s}=e,a={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};return(0,r.jsx)(n.P.ul,{variants:{hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.05}}},initial:"hidden",animate:"show",className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(e=>(0,r.jsx)(n.P.li,{variants:a,whileHover:{scale:1.03},whileTap:{scale:.98},className:"bg-indigo-50 rounded-md overflow-hidden transition-all hover:shadow-md",children:(0,r.jsxs)(l(),{href:"/course/".concat(s,"/").concat(e.id),className:"block p-4 text-indigo-700 hover:bg-indigo-100 transition-colors",children:[(0,r.jsx)("span",{className:"font-medium",children:e.id}),(0,r.jsx)("p",{className:"mt-1 text-sm text-indigo-600",children:e.name})]})},"".concat(s,"-").concat(e.id)))})}function d(e){let{semesterData:t}=e;return(0,r.jsx)(r.Fragment,{children:t.map((e,t)=>(0,r.jsxs)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"bg-white rounded-lg shadow-lg p-6 mb-8",children:[(0,r.jsxs)("h2",{className:"text-2xl font-semibold text-indigo-700 mb-4",children:[e.semester," 學期"]}),(0,r.jsx)(c,{courses:e.courses,semester:e.semester})]},e.semester))})}var h=s(760);let m=e=>fetch(e).then(e=>e.json()),u=e=>{let{onSelect:t,selectedSemesters:s}=e,[o,l]=(0,i.useState)(!1),{data:c,error:d,isLoading:u}=(0,a.Ay)("https://yc97463.github.io/ndhu-course-crawler/semester.json",m),x=c?c.filter(e=>{let[t,s]=e.split("-");return 2>=parseInt(s)&&parseInt(t)>=105}).sort((e,t)=>{let[s,r]=e.split("-").map(Number),[a,i]=t.split("-").map(Number);return a===s?i-r:a-s}):[];return(0,r.jsxs)("div",{className:"mb-8 relative",children:[(0,r.jsxs)("button",{onClick:()=>l(!o),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg shadow hover:bg-indigo-700 transition-colors flex items-center gap-2 cursor-pointer",children:[0===s.length?"選擇學期":"已選擇 ".concat(s.length," 學期"),(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 transition-transform ".concat(o?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(0,r.jsx)(h.N,{children:o&&(0,r.jsx)(n.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute z-10 mt-2 w-64 bg-white rounded-lg shadow-lg max-h-96 overflow-y-auto",children:u?(0,r.jsx)("div",{className:"p-4 text-center text-gray-500",children:"載入中..."}):d?(0,r.jsx)("div",{className:"p-4 text-center text-red-500",children:"無法載入學期資料"}):(0,r.jsxs)("div",{className:"py-2 px-1",children:[(0,r.jsx)("div",{className:"text-sm text-gray-600 px-3 py-2",children:"選擇您要查看的學期"}),x.map(e=>(0,r.jsxs)("button",{onClick:()=>{t(e),l(!1)},className:"block w-full text-left px-4 py-2 hover:bg-indigo-50 rounded-md transition-colors cursor-pointer ".concat(s.includes(e)?"bg-indigo-100 text-indigo-700":""),children:[e," 學期",s.includes(e)&&(0,r.jsx)("span",{className:"float-right text-indigo-600",children:"✓"})]},e))]})})})]})},x="ndhu-course-selected-semesters";function g(){let[e,t]=(0,i.useState)([]),[s,n]=(0,i.useState)([]);(0,i.useEffect)(()=>{let e=localStorage.getItem(x);e&&t(JSON.parse(e))},[]);let o=(0,a.Ay)(()=>0===e.length?null:"semester-courses-".concat(e.join(",")),async()=>{let t={};return await Promise.all(e.map(async e=>{try{let s=await fetch("https://yc97463.github.io/ndhu-course-crawler/".concat(e,"/main.json"));if(!s.ok)throw Error("Failed to fetch courses for semester ".concat(e));let r=await s.json();t[e]=Object.entries(r).map(e=>{let[t,s]=e;return{id:t,name:s.course_name||t}})}catch(s){console.error("Error fetching data for semester ".concat(e,":"),s),t[e]=[]}})),t});return(0,i.useEffect)(()=>{o.data&&n(e.map(e=>{var t;return{semester:e,courses:(null===(t=o.data)||void 0===t?void 0:t[e])||[]}}))},[e,o.data]),(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-8",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-indigo-800 mb-8 text-center",children:"NDHU 課程列表"}),(0,r.jsx)(u,{onSelect:e=>{t(t=>{let s=t.includes(e)?t.filter(t=>t!==e):[...t,e];return localStorage.setItem(x,JSON.stringify(s)),s})},selectedSemesters:e}),o.isLoading&&e.length>0&&(0,r.jsxs)("div",{className:"text-center p-8 bg-white rounded-lg shadow",children:[(0,r.jsx)("div",{className:"animate-spin w-12 h-12 border-4 border-indigo-600 border-t-transparent rounded-full mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-indigo-700",children:"載入課程資料中..."})]}),o.error&&(0,r.jsx)("div",{className:"text-center p-8 bg-white rounded-lg shadow",children:(0,r.jsx)("p",{className:"text-red-500",children:"載入課程資料時發生錯誤，請稍後再試"})}),0===e.length&&(0,r.jsx)("div",{className:"text-center p-8 bg-white rounded-lg shadow",children:(0,r.jsx)("p",{className:"text-gray-600",children:"請選擇一個學期以查看課程"})}),s.length>0&&(0,r.jsx)(d,{semesterData:s})]})})}function p(){return(0,r.jsx)(a.BE,{value:{revalidateOnFocus:!1,errorRetryCount:3},children:(0,r.jsx)(g,{})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[932,874,815,441,684,358],()=>t(1267)),_N_E=e.O()}]);