(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1267:(e,t,s)=>{Promise.resolve().then(s.bind(s,2516))},2516:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>E});var r=s(5155),a=s(6072),i=s(2115),l=s(9932),n=s(4653),c=s(5968),o=s(6874),d=s.n(o),x=s(5040),h=s(2138),m=s(1154),u=s(7712),g=s(4616),p=s(1482),f=s(4416),y=s(1250),b=s(7287);function j(e){let{courses:t,semester:s,viewMode:a}=e,n=(0,i.useRef)(null),c=(0,i.useRef)(null),[o,j]=(0,i.useState)([]),[v,N]=(0,i.useState)(new Set),[w,S]=(0,i.useState)(new Set);(0,i.useEffect)(()=>{let e=new Set;t.forEach(t=>{b.P.isCourseInSchedule(s,t.id)&&e.add(t.id)}),N(e)},[t,s]);let k=async(e,t)=>{if(t.preventDefault(),t.stopPropagation(),!w.has(e.id)){S(t=>new Set(t).add(e.id));try{let t=await fetch("https://yc97463.github.io/ndhu-course-crawler/".concat(s,"/course/").concat(e.id,".json"));if(!t.ok)throw Error("Failed to fetch course details");let r=await t.json(),a={course_id:r.course_id,course_name:r.course_name,english_course_name:r.english_course_name||"",teacher:Array.isArray(r.teacher)?r.teacher:[r.teacher],classroom:Array.isArray(r.classroom)?r.classroom:[r.classroom],credits:r.credits||"",class_time:r.class_time.map(e=>{var t,s;return{day:(null==(t=e.day)?void 0:t.toString())||"",period:(null==(s=e.period)?void 0:s.toString())||""}}),semester:s,departments:r.departments||[]};b.P.addCourse(s,a)?N(t=>new Set(t).add(e.id)):b.P.checkTimeConflict(s,a)?alert("無法加入課程：與現有課程時間衝突！"):alert("課程已存在於課表中！")}catch(e){console.error("Error adding course to schedule:",e),alert("加入課程時發生錯誤，請稍後再試。")}finally{S(t=>{let s=new Set(t);return s.delete(e.id),s})}}},C=(e,t)=>{t.preventDefault(),t.stopPropagation(),b.P.removeCourse(s,e.id),N(t=>{let s=new Set(t);return s.delete(e.id),s})},A=(0,i.useMemo)(()=>{let e={};t.forEach(t=>{if(t.college){let s=t.college.split("::")[0];e[s]=(e[s]||0)+1}});let s={理工學院:"blue",管理學院:"purple",人文社會科學學院:"pink",教育學院:"yellow",藝術學院:"indigo",原住民民族學院:"red",環境學院:"emerald",花師教育學院:"green",海洋科學學院:"cyan"};return[{id:"all",name:"全部",count:t.length,color:"gray"},...Object.entries(e).sort((e,t)=>{let[,s]=e,[,r]=t;return r-s}).map(e=>{let[t,r]=e;return{id:t,name:t,count:r,color:s[t]||"gray"}})]},[t]),_={gray:"bg-gray-100 text-gray-700 hover:bg-gray-200 border-gray-200",blue:"bg-blue-100 text-blue-700 hover:bg-blue-200 border-blue-200",green:"bg-green-100 text-green-700 hover:bg-green-200 border-green-200",purple:"bg-purple-100 text-purple-700 hover:bg-purple-200 border-purple-200",pink:"bg-pink-100 text-pink-700 hover:bg-pink-200 border-pink-200",yellow:"bg-yellow-100 text-yellow-700 hover:bg-yellow-200 border-yellow-200",indigo:"bg-indigo-100 text-indigo-700 hover:bg-indigo-200 border-indigo-200",red:"bg-red-100 text-red-700 hover:bg-red-200 border-red-200",emerald:"bg-emerald-100 text-emerald-700 hover:bg-emerald-200 border-emerald-200",cyan:"bg-cyan-100 text-cyan-700 hover:bg-cyan-200 border-cyan-200"},P=(0,i.useMemo)(()=>0===o.length?t:t.filter(e=>{if(!e.college)return!1;let t=e.college.split("::")[0];return o.includes(t)}),[t,o]),E=e=>{if("all"===e)return void j([]);j(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},I=()=>{j([])},z=()=>{let e=window.innerWidth;return e<768?1:e<1024?2:3},[D,T]=(0,i.useState)(z);(0,i.useEffect)(()=>{let e=()=>{T(z())};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let L=(0,y.Te)({count:P.length,getScrollElement:()=>n.current,estimateSize:()=>120,overscan:5}),O=(0,i.useMemo)(()=>{let e=[];for(let t=0;t<P.length;t+=D)e.push(P.slice(t,t+D));return e},[P,D]),H=(0,y.Te)({count:O.length,getScrollElement:()=>c.current,estimateSize:()=>140,overscan:3});if(0===t.length)return(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)(x.A,{className:"w-8 h-8 text-gray-400"})}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"沒有找到課程"}),(0,r.jsx)("p",{className:"text-gray-500",children:"這個學期暫時沒有可用的課程資料"})]});let M=e=>{let{course:t}=e,a=v.has(t.id),i=w.has(t.id);return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(d(),{href:"/course/".concat(s,"/").concat(t.id),children:(0,r.jsxs)(l.P.div,{className:"group relative bg-white border border-gray-200 rounded-xl p-4 hover:border-indigo-300 hover:shadow-md transition-all duration-200 cursor-pointer",whileHover:{scale:1.02},whileTap:{scale:.98},children:[(0,r.jsxs)("div",{className:"flex items-start justify-between h-full",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0 pr-8",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-indigo-600 rounded-full flex-shrink-0"}),(0,r.jsx)("span",{className:"text-xs font-medium text-indigo-600 uppercase tracking-wide",children:t.id}),t.college&&(0,r.jsx)("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full",children:t.college.split("::")[0]})]}),(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 group-hover:text-indigo-700 transition-colors mb-1",children:t.name.length>30?t.name.substring(0,30)+"...":t.name}),t.teacher&&(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["教師：",t.teacher.replace(/\//g,"").trim()]}),t.credits&&(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["學分：",t.credits.split("/")[0]]})]}),(0,r.jsx)(l.P.div,{className:"flex-shrink-0 ml-3 opacity-0 group-hover:opacity-100 transition-opacity",whileHover:{x:2},children:(0,r.jsx)(h.A,{className:"w-4 h-4 text-indigo-600"})})]}),(0,r.jsx)("div",{className:"absolute inset-0 bg-indigo-50/50 rounded-xl opacity-0 group-hover:opacity-100 transition-opacity -z-10"})]})}),(0,r.jsx)(l.P.button,{onClick:a?e=>C(t,e):e=>k(t,e),disabled:i,className:"absolute top-2 right-2 w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium transition-all duration-200 z-10 ".concat(a?"bg-red-100 text-red-700 hover:bg-red-200 border border-red-200":"bg-indigo-100 text-indigo-700 hover:bg-indigo-200 border border-indigo-200"," ").concat(i?"opacity-50 cursor-not-allowed":"hover:scale-110"),whileHover:i?{}:{scale:1.1},whileTap:i?{}:{scale:.9},title:a?"從課表移除":"加入課表",children:i?(0,r.jsx)(m.A,{className:"w-3 h-3 animate-spin"}):a?(0,r.jsx)(u.A,{className:"w-3 h-3"}):(0,r.jsx)(g.A,{className:"w-3 h-3"})})]})},B=e=>{let{course:t,index:a}=e,i=v.has(t.id),n=w.has(t.id);return(0,r.jsxs)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*a,duration:.3},className:"h-full relative",children:[(0,r.jsx)(d(),{href:"/course/".concat(s,"/").concat(t.id),children:(0,r.jsxs)(l.P.div,{className:"group relative bg-white border border-gray-200 rounded-xl p-4 hover:border-indigo-300 hover:shadow-md transition-all duration-200 cursor-pointer h-full",whileHover:{scale:1.02},whileTap:{scale:.98},children:[(0,r.jsxs)("div",{className:"flex items-start justify-between h-full",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0 pr-8",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-indigo-600 rounded-full flex-shrink-0"}),(0,r.jsx)("span",{className:"text-xs font-medium text-indigo-600 uppercase tracking-wide",children:t.id}),t.college&&(0,r.jsx)("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full",children:t.college.split("::")[0]})]}),(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 group-hover:text-indigo-700 transition-colors mb-1",children:t.name.length>30?t.name.substring(0,30)+"...":t.name}),t.teacher&&(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["教師：",t.teacher.replace(/\//g,"").trim()]}),t.credits&&(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["學分：",t.credits.split("/")[0]]})]}),(0,r.jsx)(l.P.div,{className:"flex-shrink-0 ml-3 opacity-0 group-hover:opacity-100 transition-opacity",whileHover:{x:2},children:(0,r.jsx)(h.A,{className:"w-4 h-4 text-indigo-600"})})]}),(0,r.jsx)("div",{className:"absolute inset-0 bg-indigo-50/50 rounded-xl opacity-0 group-hover:opacity-100 transition-opacity -z-10"})]})}),(0,r.jsx)(l.P.button,{onClick:i?e=>C(t,e):e=>k(t,e),disabled:n,className:"absolute top-2 right-2 w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium transition-all duration-200 z-10 ".concat(i?"bg-red-100 text-red-700 hover:bg-red-200 border border-red-200":"bg-indigo-100 text-indigo-700 hover:bg-indigo-200 border border-indigo-200"," ").concat(n?"opacity-50 cursor-not-allowed":"hover:scale-110"),whileHover:n?{}:{scale:1.1},whileTap:n?{}:{scale:.9},title:i?"從課表移除":"加入課表",children:n?(0,r.jsx)(m.A,{className:"w-3 h-3 animate-spin"}):i?(0,r.jsx)(u.A,{className:"w-3 h-3"}):(0,r.jsx)(g.A,{className:"w-3 h-3"})})]})};return(0,r.jsxs)("div",{className:"space-y-6",children:[A.length>1&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(p.A,{className:"w-4 h-4 text-gray-500"}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"學院篩選"}),o.length>0&&(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:["（已選擇 ",o.length," 個）"]})]}),o.length>0&&(0,r.jsx)("button",{onClick:I,className:"text-xs text-indigo-600 hover:text-indigo-700 font-medium transition-colors",children:"清除全部"})]}),o.length>0&&(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["顯示 ",(0,r.jsx)("span",{className:"font-medium text-indigo-600",children:P.length})," 門課程",P.length!==t.length&&(0,r.jsxs)("span",{className:"text-gray-500",children:[" / 共 ",t.length," 門"]})]}),(0,r.jsx)("div",{className:"flex flex-wrap gap-3",children:A.map(e=>{let t="all"===e.id?0===o.length:o.includes(e.id);return(0,r.jsxs)(l.P.button,{onClick:()=>E(e.id),className:"inline-flex items-center space-x-2 px-3 py-1 rounded-full text-sm font-medium border transition-all duration-200 ".concat(t?"".concat(_[e.color]," ring-2 ring-offset-1 ring-current shadow-sm"):"bg-white text-gray-600 hover:bg-gray-50 border-gray-200 hover:border-gray-300"),whileHover:{scale:1.05},whileTap:{scale:.95},layout:!0,children:[(0,r.jsx)("span",{children:e.name}),(0,r.jsx)("span",{className:"inline-flex items-center justify-center px-2 text-xs rounded-lg ".concat(t?"bg-white/20 text-current":"bg-gray-100 text-gray-500"),children:e.count}),t&&"all"!==e.id&&(0,r.jsx)(l.P.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},children:(0,r.jsx)(f.A,{className:"w-3 h-3"})})]},e.id)})})]}),"virtual"===a&&(0,r.jsx)("div",{ref:n,className:"h-96 overflow-auto border border-gray-200 rounded-xl bg-gray-50/50",style:{contain:"strict"},children:(0,r.jsx)("div",{style:{height:"".concat(L.getTotalSize(),"px"),width:"100%",position:"relative"},children:L.getVirtualItems().map(e=>{let t=P[e.index];return(0,r.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"".concat(e.size,"px"),transform:"translateY(".concat(e.start,"px)")},children:(0,r.jsx)("div",{className:"p-4",children:(0,r.jsx)(M,{course:t})})},e.key)})})}),"grid"===a&&P.length>50&&(0,r.jsx)("div",{ref:c,className:"h-96 overflow-auto border border-gray-200 rounded-xl bg-gray-50/50",style:{contain:"strict"},children:(0,r.jsx)("div",{style:{height:"".concat(H.getTotalSize(),"px"),width:"100%",position:"relative"},children:H.getVirtualItems().map(e=>{let t=O[e.index];return(0,r.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"".concat(e.size,"px"),transform:"translateY(".concat(e.start,"px)")},children:(0,r.jsx)("div",{className:"p-4",children:(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 h-full",children:t.map(e=>(0,r.jsx)(M,{course:e},e.id))})})},e.key)})})}),"grid"===a&&P.length<=50&&(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:P.map((e,t)=>(0,r.jsx)(B,{course:e,index:t},e.id))}),o.length>0&&0===P.length&&(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)(p.A,{className:"w-8 h-8 text-gray-400"})}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"沒有符合條件的課程"}),(0,r.jsx)("p",{className:"text-gray-500 mb-4",children:"請嘗試調整篩選條件或清除篩選"}),(0,r.jsx)("button",{onClick:I,className:"inline-flex items-center px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-lg hover:bg-indigo-700 transition-colors",children:"清除所有篩選"})]})]})}function v(e){let{semesterData:t}=e,[s,a]=(0,i.useState)("grid");return(0,r.jsx)("div",{className:"space-y-8",children:t.map((e,t)=>(0,r.jsxs)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t,duration:.5},className:"bg-white rounded-2xl shadow-sm border border-gray-200/50 overflow-hidden hover:shadow-md transition-all duration-300",children:[(0,r.jsx)("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 px-6 py-4 border-b border-gray-100",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-indigo-600 rounded-full"}),(0,r.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:[e.semester," 學期"]}),(0,r.jsx)(d(),{href:"/search/".concat(e.semester),className:"text-sm text-indigo-600 rounded px-2.5 py-1.5 transition bg-indigo-100 hover:bg-indigo-200",children:"進階搜尋"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-700",children:[e.courses.length," 門課程"]}),(0,r.jsxs)("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[(0,r.jsxs)("button",{onClick:()=>a("grid"),className:"flex items-center justify-center space-x-1 px-3 py-1.5 rounded-md text-sm font-medium transition-all min-w-[80px] ".concat("grid"===s?"bg-white text-indigo-700 shadow-sm":"text-gray-600 hover:text-gray-900"),children:[(0,r.jsx)(n.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"網格"})]}),(0,r.jsxs)("button",{onClick:()=>a("virtual"),className:"flex items-center justify-center space-x-1 px-3 py-1.5 rounded-md text-sm font-medium transition-all min-w-[80px] ".concat("virtual"===s?"bg-white text-indigo-700 shadow-sm":"text-gray-600 hover:text-gray-900"),children:[(0,r.jsx)(c.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"列表"})]})]})]})]})}),(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)(j,{courses:e.courses,semester:e.semester,viewMode:s})})]},e.semester))})}var N=s(760),w=s(9074),S=s(6474),k=s(5196);let C=e=>fetch(e).then(e=>e.json()),A=e=>{let{onSelect:t,selectedSemesters:s}=e,[n,c]=(0,i.useState)(!1),{data:o,error:d,isLoading:x}=(0,a.Ay)("https://yc97463.github.io/ndhu-course-crawler/semester.json",C),h=o?o.filter(e=>{let[t,s]=e.split("-");return 2>=parseInt(s)&&parseInt(t)>=105}).sort((e,t)=>{let[s,r]=e.split("-").map(Number),[a,i]=t.split("-").map(Number);return a===s?i-r:a-s}):[];return(0,r.jsx)("div",{className:"max-w-md mx-auto",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)(l.P.button,{onClick:()=>c(!n),className:"w-full flex items-center justify-between px-4 py-3 bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md hover:border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200",whileHover:{scale:1.01},whileTap:{scale:.99},children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(w.A,{className:"w-5 h-5 text-indigo-600"})}),(0,r.jsxs)("div",{className:"text-left",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:0===s.length?"選擇學期":"已選擇 ".concat(s.length," 個學期")}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:s.length>0&&s.slice(0,2).join(", ")+(s.length>2?" 等 ".concat(s.length," 個"):"")})]})]}),(0,r.jsx)(l.P.div,{animate:{rotate:180*!!n},transition:{duration:.2},className:"flex-shrink-0",children:(0,r.jsx)(S.A,{className:"w-5 h-5 text-gray-400"})})]}),(0,r.jsx)(N.N,{children:n&&(0,r.jsx)(l.P.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},className:"absolute z-20 w-full mt-2 bg-white border border-gray-200 rounded-xl shadow-lg max-h-80 overflow-y-auto",children:x?(0,r.jsxs)("div",{className:"p-4 text-center",children:[(0,r.jsx)("div",{className:"animate-spin w-6 h-6 border-2 border-indigo-600 border-t-transparent rounded-full mx-auto mb-2"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"載入中..."})]}):d?(0,r.jsxs)("div",{className:"p-4 text-center",children:[(0,r.jsx)("div",{className:"w-6 h-6 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-2",children:(0,r.jsx)("svg",{className:"w-4 h-4 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,r.jsx)("p",{className:"text-sm text-red-600",children:"無法載入學期資料"})]}):(0,r.jsxs)("div",{className:"py-2",children:[(0,r.jsx)("div",{className:"px-4 py-2 text-xs font-medium text-gray-500 uppercase tracking-wider border-b border-gray-100",children:"可選學期"}),h.map(e=>{let a=s.includes(e);return(0,r.jsxs)(l.P.button,{onClick:()=>{t(e)},className:"w-full flex items-center justify-between px-4 py-3 text-left hover:bg-gray-50 transition-colors ".concat(a?"bg-indigo-50 text-indigo-700":"text-gray-700"),whileHover:{backgroundColor:a?"#e0e7ff":"#f9fafb"},children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(a?"bg-indigo-600":"bg-gray-300")}),(0,r.jsxs)("span",{className:"font-medium",children:[e," 學期"]})]}),a&&(0,r.jsx)(l.P.div,{initial:{scale:0},animate:{scale:1},className:"flex-shrink-0",children:(0,r.jsx)(k.A,{className:"w-4 h-4 text-indigo-600"})})]},e)})]})})}),n&&(0,r.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>c(!1)})]})})},_="ndhu-course-selected-semesters";function P(){let[e,t]=(0,i.useState)([]),[s,l]=(0,i.useState)([]);(0,i.useEffect)(()=>{let e=localStorage.getItem(_);e&&t(JSON.parse(e))},[]);let n=(0,a.Ay)(()=>0===e.length?null:"semester-courses-".concat(e.join(",")),async()=>{let t={};return await Promise.all(e.map(async e=>{try{let s=await fetch("https://yc97463.github.io/ndhu-course-crawler/".concat(e,"/main.json"));if(!s.ok)throw Error("Failed to fetch courses for semester ".concat(e));let r=await s.json();t[e]=Object.entries(r).map(e=>{let[t,s]=e;return{id:t,name:s.course_name||t,college:s.college,offering_department:s.offering_department,teacher:s.teacher,credits:s.credits}})}catch(s){console.error("Error fetching data for semester ".concat(e,":"),s),t[e]=[]}})),t});return(0,i.useEffect)(()=>{n.data&&l(e.map(e=>{var t;return{semester:e,courses:(null==(t=n.data)?void 0:t[e])||[]}}))},[e,n.data]),(0,r.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"text-center mb-12",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"探索課程"}),(0,r.jsx)("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"選擇學期，瀏覽課程，建立您的專屬課表"})]}),(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsx)(A,{onSelect:e=>{t(t=>{let s=t.includes(e)?t.filter(t=>t!==e):[...t,e];return localStorage.setItem(_,JSON.stringify(s)),s})},selectedSemesters:e})}),n.isLoading&&e.length>0&&(0,r.jsxs)("div",{className:"text-center py-16",children:[(0,r.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-indigo-100 rounded-full mb-4",children:(0,r.jsx)("div",{className:"animate-spin w-8 h-8 border-4 border-indigo-600 border-t-transparent rounded-full"})}),(0,r.jsx)("p",{className:"text-gray-600 font-medium",children:"載入課程資料中..."})]}),n.error&&(0,r.jsxs)("div",{className:"text-center py-16",children:[(0,r.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-red-100 rounded-full mb-4",children:(0,r.jsx)("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"載入失敗"}),(0,r.jsx)("p",{className:"text-gray-600",children:"載入課程資料時發生錯誤，請稍後再試"})]}),0===e.length&&(0,r.jsxs)("div",{className:"text-center py-16",children:[(0,r.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gray-100 rounded-full mb-4",children:(0,r.jsx)("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"選擇學期開始探索"}),(0,r.jsx)("p",{className:"text-gray-600",children:"請選擇一個或多個學期以查看課程列表"})]}),s.length>0&&(0,r.jsx)(v,{semesterData:s})]})})}function E(){return(0,r.jsx)(a.BE,{value:{revalidateOnFocus:!1,errorRetryCount:3},children:(0,r.jsx)(P,{})})}},7287:(e,t,s)=>{"use strict";s.d(t,{P:()=>a});let r="ndhu-course-schedule";class a{static getScheduleData(){try{let e=localStorage.getItem(r);if(!e)return{};let t=JSON.parse(e);if("object"!=typeof t||null===t)return console.error("Invalid schedule data format"),{};return t}catch(e){return console.error("Error reading schedule data:",e),{}}}static saveScheduleData(e){try{if("object"!=typeof e||null===e)return void console.error("Invalid schedule data format");localStorage.setItem(r,JSON.stringify(e))}catch(e){console.error("Error saving schedule data:",e)}}static getSemesterCourses(e){let t=this.getScheduleData()[e]||[];return Array.isArray(t)?t:(console.error("Invalid courses data format"),[])}static addCourse(e,t){if(!e||!t||!t.course_id)return console.error("Invalid course data"),!1;let s=this.getScheduleData();return s[e]||(s[e]=[]),!(s[e].some(e=>e.course_id===t.course_id)||this.checkTimeConflict(e,t))&&(s[e].push(t),this.saveScheduleData(s),!0)}static removeCourse(e,t){if(!e||!t)return void console.error("Invalid semester or courseId");let s=this.getScheduleData();s[e]&&(s[e]=s[e].filter(e=>e.course_id!==t),this.saveScheduleData(s))}static isCourseInSchedule(e,t){return!!e&&!!t&&this.getSemesterCourses(e).some(e=>e.course_id===t)}static checkTimeConflict(e,t){if(!e||!t||!t.class_time)return!1;for(let s of this.getSemesterCourses(e))if(s.class_time){for(let e of t.class_time)if(e&&e.day&&e.period){for(let t of s.class_time)if(t&&t.day&&t.period&&e.day===t.day&&String(e.period)===String(t.period))return!0}}return!1}static getAvailableSemesters(){let e=this.getScheduleData();return Object.keys(e).filter(t=>{let s=e[t];return Array.isArray(s)&&s.length>0})}static clearSemester(e){if(!e)return;let t=this.getScheduleData();delete t[e],this.saveScheduleData(t)}static clearAll(){localStorage.removeItem(r)}}}},e=>{var t=t=>e(e.s=t);e.O(0,[341,874,938,530,441,684,358],()=>t(1267)),_N_E=e.O()}]);